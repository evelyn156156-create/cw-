# 阿里云 ECS 免费试用版 (个人版) 部署指南

恭喜您获得了阿里云 ECS 的免费试用资格！本指南专为新手设计，将手把手教您如何在这台服务器上部署最新的 CryptoIntel AI 系统。

## 准备工作

1.  **登录阿里云控制台**：访问 [阿里云 ECS 控制台](https://ecs.console.aliyun.com/)。
2.  **找到您的实例**：在左侧菜单点击 "实例"，您应该能看到您刚领取的免费试用服务器。
3.  **重置密码**：如果还没设置密码，请点击实例右侧的 "更多" -> "密码/密钥" -> "重置实例密码"，设置一个您能记住的密码（如 `MySecurePass123!`），然后**重启实例**使密码生效。

---

## 第一步：连接服务器

我们将使用阿里云自带的 "Workbench" 工具，无需下载任何软件。

1.  在实例列表中，点击实例右侧的 **"远程连接"** 按钮。
2.  选择 **"Workbench 远程连接"** (通常是第一个选项)，点击 "立即登录"。
3.  输入用户名 `root` 和您刚才设置的密码，点击确定。
4.  登录成功后，您会看到一个黑色的命令行界面，这就是服务器的终端。

---

## 第二步：安装运行环境

在终端中，复制并运行以下命令（一行一行复制，按回车执行）：

### 1. 更新系统
```bash
yum update -y
```

### 2. 安装 Node.js (版本 20)
```bash
# 添加 Node.js 源
curl -fsSL https://rpm.nodesource.com/setup_20.x | bash -

# 安装 Node.js
yum install -y nodejs

# 验证安装 (如果显示版本号则成功)
node -v
npm -v
```

### 3. 安装 PM2 (用于后台运行程序)
```bash
npm install -g pm2
```

### 4. 安装 Git
```bash
yum install -y git
```

---

## 第三步：上传代码并安装

### 1. 创建项目目录
```bash
mkdir -p /root/crypto-intel-ai
cd /root/crypto-intel-ai
```

### 2. 上传文件
由于您是新手，最简单的方法是使用 Workbench 自带的文件上传功能：
1.  在 Workbench 界面左侧，点击 **"文件管理"** 图标（文件夹形状）。
2.  进入 `/root/crypto-intel-ai` 目录。
3.  点击 **"上传文件"**。
4.  将您本地下载的项目文件（除了 `node_modules` 文件夹以外的所有文件）上传上去。
    *   **提示**：如果文件太多，建议先在本地压缩成 `project.zip`，上传后再解压。
    *   如果上传了 zip 包，运行解压命令：`unzip project.zip` (如果没有 unzip，运行 `yum install -y unzip` 安装)。

### 3. 安装依赖
确保您在项目目录内 (`cd /root/crypto-intel-ai`)，然后运行：
```bash
# 安装项目依赖 (可能需要几分钟)
npm install
```

### 4. 编译项目
```bash
# 将 TypeScript 代码编译为可运行的 JavaScript
npm run build
```
*如果看到 "Build complete" 或没有报错，说明编译成功。*

---

## 第四步：启动服务

我们将使用 PM2 来启动服务，这样即使您关闭了网页，服务也会一直运行。

```bash
# 启动服务
pm2 start npm --name "crypto-app" -- start

# 保存当前进程列表，确保重启服务器后自动启动
pm2 save
pm2 startup
```

此时，您的服务已经在服务器的 **3001** 端口运行了。

---

## 第五步：开放防火墙端口 (非常重要！)

默认情况下，阿里云只开放 22 (SSH) 和 3389 端口，您需要手动开放 3001 端口才能访问网站。

1.  回到 **阿里云 ECS 控制台** 的实例列表页面。
2.  点击您的实例 ID（蓝色的链接）进入详情页。
3.  点击顶部的 **"安全组"** 标签页。
4.  点击安全组 ID（蓝色的链接）。
5.  在 "入方向" 列表，点击 **"手动添加"**。
    *   **端口范围**：输入 `3001`
    *   **授权对象**：输入 `0.0.0.0/0` (表示允许任何人访问)
    *   **协议**：选择 `TCP`
    *   点击 **"保存"**。

---

## 第六步：访问您的网站

现在，打开浏览器，输入：
`http://您的公网IP:3001`

*例如：http://47.100.xx.xx:3001*

🎉 **恭喜！您已成功部署了 CryptoIntel AI 系统！**

---

## 常见问题

**Q: 网站打不开？**
A: 请检查第五步的 "安全组" 是否正确添加了 3001 端口。

**Q: 如何更新代码？**
A: 重复 "第三步" 的上传和编译过程，然后运行 `pm2 restart crypto-app` 重启服务即可。

**Q: 数据库在哪里？**
A: 数据存储在 `/root/crypto-intel-ai/crypto_news.db` 文件中。请定期备份此文件。
