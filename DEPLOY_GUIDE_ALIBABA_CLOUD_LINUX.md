# 阿里云 ECS (Alibaba Cloud Linux 3) 香港版 - 新手部署指南

欢迎使用阿里云 ECS！您选择的 **中国香港** 区域非常棒，最大的优势是**不需要进行 ICP 备案**，部署后通过 IP 即可直接访问，非常适合新手快速上手。

本指南专为 **Alibaba Cloud Linux 3.2104 LTS** 系统定制。

---

## 第一步：重置密码与连接

1.  **登录控制台**：访问 [阿里云 ECS 控制台](https://ecs.console.aliyun.com/)。
2.  **找到实例**：在左侧导航栏点击 "实例"，在顶部地域选择 "**中国香港**"。
3.  **重置密码**：
    *   勾选您的实例。
    *   在底部菜单点击 "更多" > "密码/密钥" > "重置实例密码"。
    *   设置一个复杂的密码（例如 `MyNewsApp2026!`），点击确认。
    *   **重要**：在更多菜单中点击 "**重启**"，选择 "强制重启"，让密码生效。
4.  **远程连接**：
    *   实例状态变为 "运行中" 后，点击右侧蓝色的 "**远程连接**"。
    *   选择第一个 "**Workbench 远程连接**"，点击 "立即登录"。
    *   用户名为 `root`，密码为您刚才设置的密码。
    *   登录成功后，您会看到黑色的命令行界面。

---

## 第二步：安装环境 (复制命令执行)

在 Workbench 的黑色窗口中，**一行一行** 复制以下命令并按回车执行：

### 1. 更新系统软件
```bash
sudo dnf update -y
```

### 2. 安装 Node.js 20 (最新版)
Alibaba Cloud Linux 3 使用 `dnf` 包管理器，我们安装 Node.js 20：

```bash
# 添加 Node.js 20 仓库
curl -fsSL https://rpm.nodesource.com/setup_20.x | sudo bash -

# 安装 Node.js
sudo dnf install -y nodejs

# 验证安装 (出现版本号 v20.x.x 即成功)
node -v
npm -v
```

### 3. 安装 PM2 (让网站在后台运行)
```bash
npm install -g pm2
```

### 4. 安装 Git 和 编译工具
```bash
sudo dnf install -y git make gcc-c++
```

---

## 第三步：上传代码

对于新手，最简单的方法是使用 Workbench 自带的文件传输功能，或者使用 Git。

### 方式 A：使用 Git 拉取 (推荐，如果您有 GitHub 仓库)
*(如果您还没有把代码推送到 GitHub，请跳到方式 B)*
```bash
# 替换为您自己的仓库地址
git clone https://github.com/您的用户名/crypto-intel-ai.git
cd crypto-intel-ai
```

### 方式 B：直接上传文件 (适合小白)
1.  在本地电脑，将项目文件夹中的所有文件（**除了 `node_modules` 文件夹**）压缩成一个 `project.zip` 压缩包。
2.  在阿里云 Workbench 界面左上角，点击 "**文件**" 图标 -> 打开侧边栏。
3.  进入 `/root` 目录。
4.  点击 "**上传文件**"，选择您的 `project.zip`。
5.  上传完成后，在终端执行解压：
    ```bash
    # 安装解压工具
    sudo dnf install -y unzip
    
    # 解压 (假设上传到了 /root/project.zip)
    unzip project.zip -d crypto-intel-ai
    
    # 进入目录
    cd crypto-intel-ai
    ```

---

## 第四步：安装与启动

确保您现在位于项目目录内 (`/root/crypto-intel-ai`)：

### 1. 安装项目依赖
```bash
npm install
```
*(这一步可能需要 1-3 分钟，请耐心等待，直到进度条跑完)*

### 2. 编译代码
```bash
npm run build
```
*(如果没有报错，说明编译成功)*

### 3. 启动服务
```bash
# 使用 PM2 启动
pm2 start npm --name "news-app" -- start

# 保存当前进程列表 (确保重启服务器后自动运行)
pm2 save
pm2 startup
```

此时，您的网站已经在服务器的 **3001** 端口运行了！

---

## 第五步：开放防火墙 (最关键一步！)

很多新手卡在这里：**必须在阿里云控制台放行端口，否则外网无法访问。**

1.  回到 **阿里云 ECS 控制台** 网页。
2.  点击您的实例 ID（蓝色链接）进入详情页。
3.  点击顶部的 "**安全组**" 选项卡。
4.  点击安全组 ID（蓝色链接）。
5.  在 "入方向" 列表，点击 "**手动添加**"：
    *   **优先级**：1
    *   **协议类型**：TCP
    *   **端口范围**：`3001`
    *   **授权对象**：`0.0.0.0/0` (允许所有 IP)
    *   点击 "**保存**"。

---

## 第六步：访问成功

打开浏览器，输入：
`http://您的公网IP:3001`

*(公网 IP 可以在 ECS 控制台实例列表中看到)*

---

## 常见问题

**Q: 为什么访问不了？**
A: 99% 的情况是**第五步安全组**没配置好。请检查是否添加了 3001 端口，且授权对象是 0.0.0.0/0。

**Q: 香港服务器需要备案吗？**
A: 不需要！您可以直接使用 IP 访问，或者解析域名到这个 IP，无需经过工信部备案。

**Q: 数据库在哪里？**
A: 数据保存在项目目录下的 `crypto_news.db` 文件中。
